/*! UX Rocket Select 
 *  jQuery based Select box replacement function 
 *  @author Bilal Cinarli <bcinarli@gmail.com> (http://bcinarli.com/) 
 *  @version 3.0.0-rc3 
 *  @build Mon Nov 23 2015 11:29:43 GMT+0200 (EET) 
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}(function(e){"use strict";"undefined"==typeof window.UXRocket&&console.warn("UXRocket Select is required UXRocket Factory to run properly. You can clone/download factory at https://github.com/uxrocket/uxrocket.factory");var t,s=1,i="uxrSelect",o=null,n={selection:'<a href="#" id="{{selectionClass}}-{{id}}" class="{{selectionClass}}{{#if multiple}} {{multipleClass}}{{/if}}{{#if disabled}} {{disabledClass}}{{/if}} {{themeCurrent}}" style="{{width}}">    <span class="{{selectionTextClass}}">{{selectionText}}</span>    <span class="{{arrowClass}} {{themeArrow}}"></span></a>',multi:'<span class="{{selectionTagClass}} {{selectionTagClass}}-{{index}}" data-index="{{index}}" data-value="{{value}}">    {{selectionText}}    <span class="{{removeSelectionClass}}">X</span></span>',search:'<span class="{{searchClass}}">   <input type="text" name="{{searchInput}}" /></span>',list:'<ul class="{{listClass}} {{themeList}}">   {{#each options}}   <li id="{{optionClass}}-{{options.index}}"{{#if options.selected}} class="{{selectedClass}} {{themeSelected}}"{{/if}}>        <a class="{{optionClass}} {{themeOption}}" data-index="{{options.index}}" data-value="{{options.value}}">{{options.text}}</a>   </li>   {{/each}}</ul>',drop:'<div id="{{dropID}}" data-select="{{id}}" class="{{dropClass}}{{#if multiple}} {{multipleClass}}{{/if}}">    {{search}}    {{list}}</div>'},a={wrapper:"",current:"",arrow:"",list:"",option:"",selected:"",search:!0,searchItemLimit:10,searchType:"starts",minLetters:2,onReady:!1,onSelect:!1,onChange:!1,onUpdate:!1,onDestroy:!1},l={focus:"focus."+i,blur:"blur."+i,change:"change."+i,click:"click."+i,keyup:"keyup."+i,keydown:"keydown."+i,input:"input."+i,resize:"resize."+i,touchend:"touchend."+i+" pointerup."+i+" MSPointerUp."+i,ready:"uxrready."+i,select:"uxrselect."+i,update:"uxrupdate."+i,destroy:"uxrdestroy."+i},r={codes:{9:"tab",13:"return",27:"esc",37:"left",38:"up",39:"right",40:"down"},tab:9,"return":13,esc:27,left:37,up:38,right:39,down:40},p={prefix:"uxr-",rocket:"uxRocket",data:i,name:"select",classes:{wrap:"wrap",ready:"ready",disabled:"disabled",selection:"selection",selectionText:"selection-text",selectionTag:"selected-tag",removeSelection:"remove-selected-tag",arrow:"arrow",multiple:"multiple",opened:"opened",drop:"drop",reverseDrop:"reverse-drop",list:"list",option:"option",optionName:"option-name",highlight:"highlight",selected:"selected",search:"search",hidden:"aria-hidden",hide:"hide"}},d=new window.uxrPluginUtils({ns:p}),h=function(t,o,n){this._instance=s,this._name=i,this._defaults=a,this.wrapped=!1,this.el=t,this.$el=e(t),this.id="uxr-select-options-"+s,this.multiple=this.el.hasAttribute("multiple"),this.disabled=this.el.hasAttribute("disabled"),this.width=this.getWidth(),this.selector=n,this.opened=!1,this.tabbed=!1,this.clicked=0,this.options=e.extend(!0,{},a,o,this.$el.data()),s++,this.init()};h.prototype.init=function(){""===this.el.id&&(this.el.id=p.data+"-"+this._instance),this.registry(),this.getOptionData(),this.decorateUI(),this.prepareDrop(),this.bindUI(),this.$el.addClass(d.getClassname("ready")),this.emitEvent("ready")},h.prototype.getSelected=function(){return{value:this.$el.val(),text:this.$el.find("option:selected").text()}},h.prototype.getOptionData=function(){var t=this,s=0;t.optionData=[],this.$el.find("option").each(function(){t.optionData.push({index:s,text:e(this).text(),value:e(this).val(),selected:e(this).is(":selected")}),s++})},h.prototype.decorateUI=function(){this.addAttributes(),this.wrap(),this.addSelection()},h.prototype.undecorateUI=function(){this.unwrap(),this.removeSelection(),this.removeAttributes()},h.prototype.wrap=function(){this.$el.parent().is("label")?this.$el.parent().addClass(d.getClassname("wrap")):(this.wrapped=!0,this.$el.wrap('<label class="'+d.getClassname("wrap")+'"></label>')),this.$el.parent().addClass(this.options.wrapper)},h.prototype.unwrap=function(){this.wrapped?this.$el.unwrap():this.$el.parent().removeClass(d.getClassname("wrap")+" "+this.options.wrapper)},h.prototype.addSelection=function(){var t=this.renderSelection();this.$selection=e(t),this.$el.after(this.$selection)},h.prototype.removeSelection=function(){this.$el.next("."+d.getClassname("selection")).remove(),delete this.$selection},h.prototype.addAttributes=function(){this.$el.addClass(d.getClassname("hidden")).attr("aria-hidden",!0)},h.prototype.removeAttributes=function(){this.$el.removeAttr("aria-hidden").removeClass(d.getClassname("hidden")+" "+d.getClassname("ready"))},h.prototype.bindUI=function(){var t=this;t.$el.on(l.focus,function(e){e.preventDefault(),t.onFocus()}).on(l.change,function(e){t.onChange(e)}).on(l.ready,function(e){t.onReady(e)}).on(l.select,function(e){t.onSelect(e)}).on(l.update,function(){t.onUpdate()}).on(l.destroy,function(){t.onDestroy()}),t.$selection.on(l.keydown,function(e){e.preventDefault()}).on(l.keyup,function(e){e.preventDefault(),t.onKeyup(e)}).on(l.focus,function(e){return e.preventDefault(),t.disabled?!1:void t.onFocus()}).on(l.blur,function(){o&&0===t.clicked&&t.opened&&!t.tabbed&&t.onBlur()}).on(l.click,function(e){return e.stopPropagation(),e.preventDefault(),t.disabled?!1:void t.onClick(e)}).on(l.click,"."+d.getClassname("removeSelection"),function(s){return t.disabled?!1:void t.removeTag(e(s.target))}),e(document).on(l.click,function(e){(0===t.$drop.has(e.target).length||0===t.$selection.has(e.target))&&t.onBlur()})},h.prototype.bindDropUI=function(){var t=this;t.$drop.on(l.click,"."+d.getClassname("option"),function(s){s.preventDefault(),t.emitEvent("select"),t.select(e(s.currentTarget))}).on(l.keyup+" "+l.input,"."+d.getClassname("search")+" input",function(e){e.preventDefault(),(e.keyCode===r.up||e.keyCode===r.down)&&t.navigateWithArrow(r.codes[e.keyCode]),e.keyCode===r["return"]&&t.navigateWithEnter(),this.value.length>=t.options.minLetters?t.search(this.value):t.setOriginalList()})},h.prototype.unbindUI=function(){this.emitEvent("destroy"),this.$el.off("."+i)},h.prototype.select=function(e){var t=d.getClassname("selected"),s=d.getClassname("highlight"),i=d.getClassname("selectionText"),o=d.getClassname("selectionTag"),a=d.getClassname("removeSelection"),l=e.parent(),r=l.attr("id"),p=e.data("index"),h=e.data("value"),c=e.text();if(this.multiple){if(l.hasClass(t))this.$el.find("option:eq("+p+")").prop("selected",!1),l.removeClass(t),this.$selection.find("."+o+"-"+p).remove(),null===this.$el.val()&&this.$selection.find("."+i).text(this.multiplePlaceholder);else{var u=d.render(n.multi,{selectionText:c,selectionTagClass:o,removeSelectionClass:a,index:p,value:h});l.addClass(t),null===this.$el.val()?this.$selection.find("."+i).html(u):this.$selection.find("."+i).append(u),this.$el.find("option:eq("+p+")").prop("selected",!0)}this.setDropPosition()}else this.$list.find("."+s).removeClass(s),this.$list.find("."+t).removeClass(t),this.$selection.find("."+i).text(c),this.$el.find("option:eq("+p+")").prop("selected",!0),this.onBlur(),this.$list.find("#"+r).addClass(t);this.emitEvent("change")},h.prototype.removeTag=function(t){var s=t.parent().data("index");this.$el.find("option:eq("+s+")").prop("selected",!1),e("#"+d.getClassname("option")+"-"+s).removeClass(d.getClassname("selected")),t.parent().remove(),null===this.$el.val()&&this.$selection.find("."+d.getClassname("selectionText")).text(this.multiplePlaceholder),this.setDropPosition()},h.prototype.search=function(t){var s,i,o=this,n=this.$drop.find("."+d.getClassname("list"));s=e.map(this.optionData,function(e){return o._search(e,t)?e:void 0}),i=this.renderList(s),n.replaceWith(i)},h.prototype._search=function(e,t){var s=e.text.replace("İ","i").toLowerCase(),i=e.value.replace("İ","i").toLowerCase(),o=t.replace("İ","i").toLowerCase();switch(this.options.searchType){default:case"starts":return 0===s.indexOf(o)||0===i.toLowerCase().indexOf(o);case"contains":return s.indexOf(o)>-1||i.toLowerCase().indexOf(o)>-1}},h.prototype.showDrop=function(){this.$drop.appendTo("body"),this.setDropPosition(),this.setListPosition(),this.$list.find("."+d.getClassname("highlight")).removeClass(d.getClassname("highlight")),this.bindDropUI()},h.prototype.hideDrop=function(){this.$drop.remove(),this.$search.val(""),this.setOriginalList()},h.prototype.navigateWithEnter=function(){if(!this.multiple){var e=d.getClassname("highlight"),t=this.$list.find("."+e);t.length>0&&(t.removeClass(e),this.emitEvent("select"),this.select(t.find("a")))}},h.prototype.navigateWithArrow=function(e){var t,s="up"===e?"prev":"next",i=d.getClassname("highlight"),o=this.$list.find("."+i).length>0?this.$list.find("."+i):this.$list.find("."+d.getClassname("selected")),n=this.$list.offset().top,a=this.$list.scrollTop(),l=this.$list.height();if(o.length)t=o.removeClass(i)[s]().addClass(i),t.length||(t="prev"===s?this.$list.find("li").last().addClass(i):this.$list.find("li").first().addClass(i)),t.length&&("down"===e?t.offset().top>n+l-t.height()?this.$list.scrollTop(a+t.height()):t.offset().top<n&&this.$list.scrollTop(0):t.offset().top<n?this.$list.scrollTop(a-t.height()):t.offset().top>n+l&&this.$list.scrollTop(a+t.offset().top));else{var r="up"===e?"last":"first";t=this.$list.find("li")[r]().addClass(i)}},h.prototype.renderSelection=function(){var e={id:this.el.id,selectionClass:d.getClassname("selection"),multiple:this.multiple,multipleClass:d.getClassname("multiple"),disabled:this.disabled,disabledClass:d.getClassname("disabled"),width:"width:"+this.width,selectionTextClass:d.getClassname("selectionText"),selectionText:this.getSelected().text,arrowClass:d.getClassname("arrow"),themeCurrent:this.options.current,themeArrow:this.options.arrow};return this.multiple&&(this.multiplePlaceholder=this.$el.attr("placeholder")||this.options.placeholder||"",e.selectionText=this.multiplePlaceholder),d.render(n.selection,e)},h.prototype.renderSearchField=function(){var e={searchClass:d.getClassname("search"),searchInput:d.getClassname("search")+"-"+this._instance,list:this.id};return d.render(n.search,e)},h.prototype.renderList=function(e){var t={listClass:d.getClassname("list"),selectedClass:d.getClassname("selected"),optionClass:d.getClassname("option"),options:e||this.optionData,themeList:this.options.list,themeSelected:this.options.selected,themeOption:this.options.option};return d.render(n.list,t)},h.prototype.renderDrop=function(){var e={dropID:this.id,id:this.el.id,dropClass:d.getClassname("drop"),multiple:this.multiple,multipleClass:d.getClassname("drop")+"-multiple",search:this.renderSearchField(),list:this.renderList()};return d.render(n.drop,e)},h.prototype.prepareDrop=function(){this.$drop=e(this.renderDrop()),this.$list=this.$drop.find("."+d.getClassname("list")),this.$search=this.$drop.find("."+d.getClassname("search")+" input"),this.setDropPosition(),this.setListPosition(),!this.options.search||this.options.searchItemLimit>=this.optionData.length?this.$search.parent().addClass(d.getClassname("hide")):this.$search.parent().removeClass(d.getClassname("hide"))},h.prototype.setDropPosition=function(){this.$drop.css({top:this.getPosition().top+this.$selection.height(),left:this.getPosition().left,minWidth:this.$selection.outerWidth()}).removeClass(d.getClassname("reverseDrop")),this.inViewport()||this.$drop.css({top:this.getPosition().top-this.$drop.height()}).addClass(d.getClassname("reverseDrop"))},h.prototype.setListPosition=function(){var e=this.$list.find("."+d.getClassname("selected")+":eq(0)");1===e.length&&this.$list.scrollTop(e.offset().top-this.$list.offset().top-this.$list.height()/2)},h.prototype.setOriginalList=function(){this.$drop.find("."+d.getClassname("list")).replaceWith(this.$list)},h.prototype.inViewport=function(){for(var e=this.$drop.get(0),t=e.offsetTop,s=e.offsetLeft,i=e.offsetWidth,o=e.offsetHeight;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,s+=e.offsetLeft;return t>=window.pageYOffset&&s>=window.pageXOffset&&t+o<=window.pageYOffset+window.innerHeight&&s+i<=window.pageXOffset+window.innerWidth},h.prototype.onKeyup=function(e){switch(e.keyCode){case r.tab:this.tabbed=!0,this.onFocus();break;case r["return"]:this.navigateWithEnter();break;case r.up:case r.down:this.navigateWithArrow(r.codes[e.keyCode])}},h.prototype.onClick=function(t){e(t.target).is("."+d.getClassname("removeSelection"))||(this.clicked++,this.opened?(this.opened&&this.clicked%2===0||this.opened&&this.tabbed)&&this.onBlur():this.onFocus())},h.prototype.onFocus=function(){t.close(this._instance),o=this._instance,this.showDrop(),this.$selection.addClass(d.getClassname("opened")),this.opened=!0},h.prototype.onBlur=function(){o=null,this.hideDrop(),this.$selection.removeClass(d.getClassname("opened")),this.opened=!1,this.tabbed=!1,this.clicked=0},h.prototype.onChange=function(e){d.callback(this.options.onChange)},h.prototype.onReady=function(){d.callback(this.options.onReady)},h.prototype.onSelect=function(){d.callback(this.options.onSelect)},h.prototype.onUpdate=function(){d.callback(this.options.onUpdate)},h.prototype.onDestroy=function(){d.callback(this.options.onDestroy)},h.prototype.update=function(){this.emitEvent("update")},h.prototype.close=function(){this.onBlur()},h.prototype.destroy=function(){this.emitEvent("destroy"),this.unbindUI(),this.undecorateUI(),this.$el.removeData(i)},h.prototype.registry=function(){var e=this.$el.data(p.rocket)||{};e[p.data]={hasWrapper:!0,wrapper:p.wrap,ready:d.getClassname("ready"),selector:this.selector,options:this.options},this.$el.data(p.rocket,e)},h.prototype.getPosition=function(){return{top:this.$selection.offset().top,left:this.$selection.offset().left}},h.prototype.getWidth=function(){var t,s=this.$el.attr("class"),i=this.$el.attr("style"),o=e(document.createElement("div")).css("display","none"),n="";return s&&(n+=' class="'+s.replace(d.getClassname("ready"),"").replace(d.getClassname("hidden"),"")+'"'),i&&(n+=' style="'+i+'"'),o.html("<div "+n+"></div>").appendTo("body"),t=o.find("div").css("width"),"0px"===t&&(t=this.$el.width()+"px"),o.remove(),t},h.prototype.emitEvent=function(e){this.$el.trigger(l[e])},t=e.fn.select=e.fn.uxrselect=e.fn.uxitdselect=e.uxrselect=function(t){var s=this.selector;return this.each(function(){e.data(this,p.data)||e.data(this,p.data,new h(this,t,s))})},t.update=function(t,s){var i,o;"undefined"==typeof s&&"object"==typeof t?(i=e("."+d.getClassname("ready")),o=t):(i=e(t),o=s),i.filter("select").each(function(){var t=e(this),s=t.data(p.data),i=s.options;s.options=e.extend(!0,{},i,o),d.callback(i.onUpdate)})},t.close=function(){var t=e("."+d.getClassname("drop"));t.length>0&&t.each(function(){var t=e(d.escapeSelector("#"+e(this).data("select"))).data(p.data);t!==o&&t.close()})},t.destroy=function(t){var s=e("undefined"==typeof t?"."+d.getClassname("ready"):t);s.each(function(){e(this).data(p.data).destroy()})},e(document).on(l.click,function(s){(0===e("."+d.getClassname("drop")).has(s.target).length||0===e("."+d.getClassname("selection")).has(s.target))&&t.close()}),e(window).on(l.resize+" "+l.touchend,function(){var t=e("."+d.getClassname("drop"));1===t.length&&e(d.escapeSelector("#"+t.data("select"))).data(p.data).setDropPosition()}),t.version="3.0.0-rc3",t.settings=a,t.namespace=p});