/**
 * UX Rocket
 * jQuery based Select box replacement function
 * @author Bilal Cinarli
 */
;(function($){var f,defaults={wrapper:'',current:'',arrow:'',list:'',option:'',selected:'',onReady:false,onSelect:false,onUpdate:false,onRemove:false},events={blur:'blur.uxSelect',change:'change.uxSelect',click:'click.uxSelect',focus:'focus.uxSelect',keydown:'keydown.uxSelect'},ns={rocket:'uxRocket',data:'uxSelect',ready:'uxitd-select-ready',index:'uxitd-select-index-',rocketWrap:'uxitd-plugin-wrap',wrap:'uxitd-select-wrap',list:'uxitd-select-list',item:'uxitd-select-list-item',option:'uxitd-select-option',selected:'uxitd-select-option-selected',current:'uxitd-select-current',text:'uxitd-select-current-text',arrow:'uxitd-select-arrow',readonly:'uxitd-select-readonly',disabled:'uxitd-select-disabled',focused:'uxitd-select-focused'},index=1;var g=function(a,b,c){var d,$el=$(a),id=$el.attr('id');if(id===undefined){$el.attr('id',ns.index+index);id=ns.index+index}d=$.extend({},defaults,b,$el.data(),{'id':id,'index':index,'selector':c});delete d[ns.rocket];$el.data(ns.data,d);n($el);h($el);q(d.onReady);i($el);$el.on(events.keydown,function(e){$('.'+ns.selected).removeClass(ns.selected+' '+d.selected)});index++};var h=function(a){var b,_opts=a.data(ns.data),$current=o(a.find(':selected').text()),optionList=m(a);b=' '+a.context.className.replace(ns.ready,'')+' '+ns.wrap+'-'+_opts.index;if(_opts.selector.charAt(0)=='.'){b=b.replace(' '+_opts.selector.substr(1),'')}if(a.is('.readonly')){b+=' '+ns.readonly}if(a.is(':disabled')){b+=' '+ns.disabled}if(a.parent().is('.'+ns.rocketWrap)){a.parent().addClass(ns.wrap+' '+_opts.wrapper+b)}else if(a.parent().is('label')&&a.is(':only-child')){a.parent().addClass(ns.rocketWrap+' '+ns.wrap+' '+_opts.wrapper+b)}else if(!a.parent().is('label')){a.wrap('<label class="'+ns.rocketWrap+' '+ns.wrap+' '+_opts.wrapper+b+'"></label>')}else{a.wrap('<span class="'+ns.rocketWrap+' '+ns.wrap+' '+_opts.wrapper+b+'"></span>')}a.after('<span class="'+ns.current+' '+ns.current+'-'+_opts.index+'  '+_opts.current+'">'+'   <span class="'+ns.text+'">'+$current+'</span>'+'   <span class="'+ns.arrow+' '+_opts.arrow+'"></span>'+'</span>');$('body').append(optionList)};var i=function(b){var c=b.data(ns.data);$('#'+ns.list+'-'+c.index).not('.'+ns.readonly).on(events.click,'.'+ns.option,function(e){e.preventDefault();l($(this))});b.not('.readonly').off(events.focus).on(events.focus,function(e){var a=$(this);k(a)}).off(events.change).on(events.change,function(e){var a=b.val(),id=b.attr('id'),$current=b.siblings('.'+ns.current).find('.'+ns.text),$options=$('.'+ns.list).filter('[data-select="'+id+'"]').find('.'+ns.option),$selected=$options.filter('[data-value="'+a+'"]');$current.html($selected.html());$selected.addClass(ns.selected);b.on(events.keydown,function(e){if(!e)e=b.event;if(e.keyCode=='13'){k(b)}});q(c.onSelect)}).off(events.blur).on(events.blur,function(e){$(this).animate({opacity:1},150,function(){$(this).removeClass(ns.focused)})});$(document).on(events.click,function(e){if(!$(e.target).is('.'+ns.wrap+', .'+ns.wrap+' *')){$("."+ns.list).hide();$("."+ns.focused).removeClass(ns.focused)}});$('body').on('DOMNodeRemoved',function(e){var a=b[0];if(e.target===a){if(e.originalEvent.relatedNode!==a){setTimeout(function(){j(c.index)},1)}}})};var j=function(a){$('.'+ns.current+'-'+a).unwrap().remove();$('#'+ns.list+'-'+a).remove()};var k=function(a){var b=a.attr('id'),pos=a.offset(),$w=a.parents('.'+ns.wrap).width(),$lists=$('.'+ns.list),$list=$lists.filter('[data-select="'+b+'"]');$lists.not($list).hide();$list.css({minWidth:$w,top:pos.top,left:pos.left}).toggle();a.toggleClass(ns.focused)};var l=function(a){var b=a.parents('.'+ns.list),$el=$(p("#"+b.data('select'))),_opts=$el.data(ns.data),$v=a.data('value');b.find('.'+ns.selected).removeClass(ns.selected+' '+_opts.selected);$el.val($v).trigger(events.change)};var m=function(b){var c,_opts=b.data(ns.data),id=b.attr('id'),readonly='';if(b.is('.readonly')){readonly=' '+ns.readonly}c='<ul id="'+ns.list+'-'+_opts.index+'" data-select="'+id+'" class="'+ns.list+' '+_opts.list+readonly+'">';b.find('option').each(function(){var a=$(this);c+='<li class="group '+ns.item+'"><a class="group '+ns.option+' '+_opts.option;if(a.is(':selected')){c+=' '+ns.selected+' '+_opts.selected}c+='" data-index="'+a.index()+'" data-value="'+a.val()+'">'+o(a.text())+'</a></li>'});c+='</ul>';return c};var n=function(a){var b=a.attr('id'),$listUI=$('ul[data-select="'+b+'"]');if($listUI.length>0){$listUI.remove()}};var o=function(a){return a.replace(/\[/g,'<').replace(/]/g,'>')};var p=function(a){var b=a.charAt(0)==='#',re=/([ !"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~])/g;return b?'#'+a.substring(1).replace(re,'\\$1'):a};var q=function(a){if(typeof a==='function'){a.apply(this)}else{if(a!==false){var b=new Function('return '+a);b()}}};f=$.fn.select=$.uxselect=function(b){var c=this.selector;return this.each(function(){var a=$(this),uxrocket=a.data(ns.rocket)||{},select;if(!a.is('select')||a.hasClass(ns.ready)){return}a.addClass(ns.ready);uxrocket[ns.data]={'hasWrapper':true,'wrapper':ns.wrap,'ready':ns.ready,'selector':c,'options':b};a.data(ns.rocket,uxrocket);a.on(events.keydown,function(e){if(!e)e=a.event;if(e.keyCode=='13'){return false}});select=new g(this,b,c)})};f.update=function(b){var c=b!==undefined?$(b):$("select."+ns.ready);c.each(function(){var a=$(this).data(ns.data),optionList=m($(this)),$current=o($(this).find(':selected').text());$(this).next('.'+ns.current).find('.'+ns.text).text($current);$('.'+ns.list).filter('[data-select="'+$(this).attr('id')+'"]').replaceWith(optionList);i($(this));q(a.onUpdate)})};f.remove=function(b){var c=b!==undefined?$(b):$("select."+ns.ready);c.each(function(){var a=$(this),_instance=a.data(ns.data),_uxrocket=a.data(ns.rocket);$('#'+ns.list+'-'+_instance.index).remove();a.next('.'+ns.current).remove();a.parent().removeClass(ns.wrap+' '+ns.readonly+' '+_instance.wrapper);a.off(events.focus+' '+events.change+' '+events.blur+' '+events.keydown);$(document).off(events.click);a.removeData(ns.data);delete _uxrocket[ns.data];a.data(ns.rocket,_uxrocket);a.removeClass(ns.ready);q(_instance.onRemove)})};f.version="2.8.3";f.settings=defaults})(jQuery);